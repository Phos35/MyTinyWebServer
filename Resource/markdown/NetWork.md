# 计算机网络

1. 介绍一下HTTP协议

   > 超文本传输协议。
   > 是一种无状态协议，即协议本身对发送过的请求何通信状态不会做持久化处理，这样是为了保持协议的简单性，从而能够快速处理大量事务，提高效率。
   > 但实际应用中我们往往需要记录请求相关的信息——如请求发起者的身份等，因此需要使用cookie等技术来完成状态信息的存储。

2. HTTPS和HTTP的区别

   > 1. URL
   > 2. 端口号：443， 80
   > 3. 安全性
   > 4. 性能

3. HTTPS加密的过程

   > TODO

4. TCP[^1]和UDP[^2]的区别

   > 1. 连接方式
   > 2. 服务形式
   > 3. 数据传输
   > 4. 可靠性
   > 5. 控制
   > 6. 报文首部
   > 7. 分片

5. 本地序、网络序、大小端

   > 1. 大端
   > 2. 小端
   > 3. 网络序
   > 4. 本地序

6. TCP通信过程
   ![](E:\面试资料\面经记录\images\TCP_Connection.png)

7. TCP状态转换
   ![TCP_DFA](./images/TCP_DFA.png)

8. TCP三次握手原因？

   > 1. 避免历史连接重复初始化
   >    假设Client第一次SYN报文阻塞在网络中导致Client超时重发SYN，新的SYN报文建立连接通信完成后，旧的SYN报文到达服务端，此时服务端返回ACK。假设只有两次握手，则此时服务端就进入了ESTABLISHED状态，建立了连接，而客户端这边则不会做出响应，这就造成了无效连接建立。
   > 2. 避免资源浪费
   >    上述无效连接就造成了服务端的资源浪费，因此需要三次握手
   > 3. 同步双方初始序列号
   >    1. 第一次握手结束：服务端知道了客户端的初始序列号 -- 服务端确定自己的收正常，确定客户端发正常
   >    2. 第二次握手结束：客户端知道了服务端已经知晓自己的初始序列号--客户端确定自己的发正常，服务端的收发正常；客户端知道了服务端的初始序列号 -- 客户端确定了自己的收正常
   >    3. 第三次握手结束：服务端知道了客户端已经知晓自己的初始序列号 -- 客户端确定了自己的发正常，客户端的收正常

9. TCP四次挥手原因？

   > 1. 服务端接收到FIN报文后仍有可能需要发送数据，因此FIN和ACK分离，造成了比握手多一次。若服务端接收到FIN后无数据发送，则可以合并ACK和FIN，减少一次挥手

10. TIME_WAITE等待2MSL的原因

   > 1. 保证连接可靠关闭
   >    假设最后一个ACK丢失，则MSL内服务端重发FIN报文，2MSL内到达客户端，从而使得客户端重发ACK并重置等待时间，由此可以确保服务端接收到ACK报文并正确关闭连接
   > 2. 保证旧连接的报文全部消失在网络中，避免这些报文影响新连接
   >    等待2MSL就可以使得无论是C->S还是S->C方向上的数据均超过MSL，使得旧连接报文全部消失。

11. TCP可靠传输的保证有哪些？

    > 1. 校验和
    > 2. 序列号和确认重传机制
    > 3. 拥塞控制：保证低丢包
    > 4. 流量控制：平衡收发双方的处理能力。重点：滑动窗口
    
12. TCP滑动窗口详细

    1. 滑动窗口模型
       ![Sliding_Window_Model](./images/Sliding_Window_Model.png)

    2. GBN(Go Back N)

       > 1. 累计确认机制
       > 2. 接受方：丢弃未按序到达的分组，并重传已按序到达的最后一个分组的ACK
       > 3. 发送方：重传超时包开始后续的所有包
       > 4. 定时器：只为最早送出且未确认的包设置定时器

    3. SR(Selcetive Repeat)

       > 1. 分组单独确认机制
       > 2. 接收方：
       >    1. 收到窗口前的包，重传该包对应的ACK
       >    2. 收到窗口内按序的包，则上传连续按序的包
       >    3. 收到窗口内乱序的包，进行缓存
       > 3. 发送发：只重传超时的单个packet
       > 4. 注意窗口大小设置：若序号位数为k位，则窗口大小最大为：$2^{k - 1}$，这是为了避免接受序号出现重叠造成乱序接收。eg：
       >    序号：0~3，窗口大小：3
       >    第一次发送：0，1，2发出
       >    第一次接收：0，1，2全部接收，返回ACK2，但ACK丢失
       >    第二次发送：因等待ACK超时，重发0，1，2。此时的0，1，2为旧包
       >    第二次接收：接收窗口范围为3~1，此时0，1符合接收范围，进行了接收，但实际上是接收了重复的包，协议失败
       > 5. 为每个packet设置定时器

    4. TCP采用的方案：GBN与SR的混合

       > 1. 确认机制既可类似GBN也可类似SR（即累计确认和选择确认是可选的）
       > 2. 重传和缓存类似SR：只重传超时的单独帧；缓存乱序到达的包
       > 3. 定时器类似GBN：只为最小序号的已发送未确认包设置定时器

    5. 较为详细的参考：[計算機網路概論 GBN、SR、TCP 比較](https://blog.yfxie.com/comparison-of-network-gbn-sr-and-tcp/)

13. TCP报文选项字段

    > 1. 结构：
    >    +------------ +------------+-------------------+
    >    |    kind    |  length  |          info      ~
    >    +------------ +------------+-------------------+
    >        1 byte       1 byte            n byte
    >
    > 2. 常用选项
    >
    >    | kind | length | name  | description  |
    >    | ---- | ------ | ----- | ------------ |
    >    | 0    |        |       |              |
    >    | 1    |        |       |              |
    >    | 2    |        |       |              |
    >    | 3    | 3      | WSOPT | 窗口扩大系数 |
    >    |      |        |       |              |
    >    |      |        |       |              |
    >
    
14. TCP拥塞控制

    > 1. 基础结构
    >    1. 拥塞窗口大小 cwnd
    >    2. 慢启动阈值 ssthresh
    > 2. 慢启动
    >    1. 核心：在cwnd < ssthresh时，每个ACK扩大1cwnd
    >    2. 在理想情况下，每个RTT内ACK报文是翻倍的，因此，cwnd的增长是指数型
    > 3. 拥塞避免
    >    1. 核心：在cwnd > ssthresh时，每个RTT内扩大1cwnd
    >    2. 在理想情况下，cwnd线性增长
    > 4. 拥塞发生
    >    1. ssthresh = cwnd / 2
    >    2. cwnd = 1
    >    3. 重新开始慢启动
    > 5. 快重传
    >    1. 启动机制：连续收到3个冗余重复ACK（即共收到4个一样的ACK）时，可以认为网络拥塞并不严重，此时需要及时重传丢失的报文，进入快恢复的状态
    > 6. 快恢复
    >    1. ssthresh = cwnd / 2
    >    2. cwnd = ssthresh + 3（+3为网络报量恒定的一种思想）
    >    3. 重传指定报文：
    >       若超时，则拥塞发生；
    >       若仍接收到重复ACK则cwnd += 1并继续重传；
    >       若接收到新的ACK，则令cwnd = ssthresh，进入拥塞避免阶段






[^1]:[TCP报文头部]![TCP报文头部](./images/TCP_Header.png)
[^2]:[UDP报文头部]![UDP报文头部](./images/UDP_Header.png)